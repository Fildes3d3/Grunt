{% extends '::base.html.twig' %}
{% block body %}
{{ parent() }}
<div class="row">
    <div class="col-md-8">
    {% if foundArticle is not null %}
        <div class="row">
            <div class="media">
                <h2>Am gasit in categoria: {{ category }} <h3><strong><em>{{ foundArticle.PostTitle }}</em></strong></h3></h2>
                    <div class="caption">
                        <p><em>{{ foundArticle.postData|truncate(1000, true)|raw }}</em></p>
                        <h4><em><strong>Scris maiastru in anul domnului: {{ foundArticle.ArticleDate|date('Y d M') }}</strong></em></h4>
                        <div class="fb-like" data-href="{{  app.request.uri  }}" data-layout="button"
                             data-action="like" data-size="large" data-show-faces="true"
                             data-share="true">
                        </div>
                    </div>
            </div>
        </div>
        {% if is_granted('ROLE_USER') %}
        <div class="row ">
            <div class="col-md-10">
                <h3>Comentezi?! <strong>
                            <em>...adica e plin de critici...toata lumea se pricepe....</em></strong></h3>
                {% for flashMessage in app.session.flashbag.get('succes') %}
                <div class="panel-heading">
                    <div class="alert alert-success alert-dismissable" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span></button>
                        <h2>{{ flashMessage }}</h2>
                    </div>
                </div>
                {% endfor %}
                {% for flashMessage in app.session.flashbag.get('comment_exist') %}
                <div class="panel-body">
                    <div class="panel-heading">
                        <div class="alert alert-warning alert-dismissable" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span></button>
                            <h2>{{ flashMessage }}</h2>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <div class="panel-body">
                    <form method="post" id="commentform" name="commentform" enctype="multipart/form-data"
                        action="{{ path ('comment_garaj', {'page' : foundArticle.PostCategory}) }}">
                    <h4>Baga Comentariul...</h4>
                        <input type="hidden"  name="articleId" value="{{ foundArticle.Id }}">
                        <textarea id="comment" name="comment" class="form-control" rows="4" ></textarea>
                        <div class="row">
                            <div class="col-xs-2 padding-top-10">
                                <button type="submit" class="btn btn-info">Trimite-ti Parerea</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="panel-body">
                    <ul class="comment">
                    {% for comment in comments %}
                        {% if foundArticle.Id == comment.ArticleId %}
                            <li>
                                <p><span class="glyphicon glyphicon-user"> Comentariul lui: </span>
                                    <em> {{ comment.user.username }} </em></p>
                                <p><span class="glyphicon glyphicon-time"> din anul domnului: </span>
                                    <em> {{ comment.commentDate|date('Y d M') }} </em></p>
                                <p><span class="glyphicon glyphicon-comment"> care zice ca: </span>
                                    <em> {{ comment.comment }} </em></p>
                                <button type="button" class="btn btn-info"
                                        data-toggle="modal" data-target="#commentRespModal{{ comment.id }}" >Raspunde</button>
                            </li>
                        {% for responses in responses %}
                            {% if comment.id == responses.commentId.id %}
                                <li class="response">
                                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                        <div class="panel panel-default">
                                            <div class="panel-heading" role="tab" id="headingOne">
                                                <h4 class="panel-title">
                                                    <a role="button" data-toggle="collapse" data-parent="#accordion1"
                                                       href="#collapse{{ responses.id }}" aria-expanded="true" aria-controls="collapseOne">
                                                        <em> Vezi raspunsul lui {{ responses.user.username }} </em></a>
                                                </h4>
                                            </div>
                                            <div id="collapse{{ responses.id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                                <div class="panel-body">
                                                    <p><span class="glyphicon glyphicon-user"> Raspunsul lui: </span>
                                                        <em> {{ responses.user.username }} </em></p>
                                                    <p><span class="glyphicon glyphicon-time"> din anul domnului: </span>
                                                        <em> {{ responses.commentDate|date('Y d M') }} </em></p>
                                                    <p><span class="glyphicon glyphicon-comment"> care zice ca: </span>
                                                        <em> {{ responses.commentresponse }} </em></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endif %}
                        {% endfor%}
                        {% endif %}
                    {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        {% endif %}
    {% else %}
        {% for articleMain in Main %}
        <div class="row">
            <div class="media">
                <h2>Ultimele Articole {{ category }}</h2>
                <div class="caption">
                    <h3><strong>{{ articleMain.PostTitle }}</strong></h3>
                    <p><em>{{ articleMain.postData|raw }}</em></p>
                    <h4><em><strong>Scris maiastru in anul domnului: {{ articleMain.ArticleDate|date('Y d M') }}</strong></em></h4>
                    <div class="fb-like" data-href="{{  app.request.uri  }}" data-layout="button"
                         data-action="like" data-size="large" data-show-faces="true"
                         data-share="true">
                    </div>
                </div>
            </div>
        </div>
            {% if is_granted('ROLE_USER') %}
            <div class="row ">
                <div class="col-md-10">
                    <h3>Comentezi?! <strong>
                            <em>...adica e plin de critici...toata lumea se pricepe....</em></strong></h3>
                    {% for flashMessage in app.session.flashbag.get('succes') %}
                        <div class="panel-heading">
                            <div class="alert alert-success alert-dismissable" role="alert">
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span></button>
                                <h2>{{ flashMessage }}</h2>
                            </div>
                        </div>
                    {% endfor %}
                        <div class="panel-body">
                    {% for flashMessage in app.session.flashbag.get('comment_exist') %}
                            <div class="panel-heading">
                                <div class="alert alert-warning alert-dismissable" role="alert">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                        <span aria-hidden="true">&times;</span></button>
                                    <h2>{{ flashMessage }}</h2>
                                </div>
                            </div>
                    {% endfor %}
                        </div>
                        <div class="panel-body">
                            <form method="post" id="commentform" name="commentform" enctype="multipart/form-data"
                                action="{{ path ('comment_garaj', {'page' : articleMain.postCategory}) }}">
                                <h4>Baga Comentariul...</h4>
                                <input type="hidden"  name="articleId" value="{{ articleMain.Id }}">
                                <textarea id="comment" name="comment" class="form-control" rows="4" ></textarea>
                                    <div class="row">
                                        <div class="col-xs-2 padding-top-10">
                                            <button type="submit" class="btn btn-info">Trimite-ti Parerea</button>
                                        </div>
                                    </div>
                            </form>
                        </div>
                        <div class="panel-body">
                            <ul class="comment">
                            {% for comment in comments %}
                                {% if articleMain.Id == comment.ArticleId %}
                                <li>
                                    <p><span class="glyphicon glyphicon-user"> Comentariul lui: </span>
                                        <em> {{ comment.user.username }} </em></p>
                                    <p><span class="glyphicon glyphicon-time"> din anul domnului: </span>
                                        <em> {{ comment.commentDate|date('Y d M') }} </em></p>
                                    <p><span class="glyphicon glyphicon-comment"> care zice ca: </span>
                                        <em> {{ comment.comment }} </em></p>
                                    <button type="button" class="btn btn-info"
                                            data-toggle="modal" data-target="#commentRespModal{{ comment.id }}" >Raspunde</button>
                                </li>
                                {% for responses in responses %}
                                    {% if comment.id == responses.commentId.id %}
                                    <li class="response">
                                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                            <div class="panel panel-default">
                                                <div class="panel-heading" role="tab" id="headingOne">
                                                    <h4 class="panel-title">
                                                        <a role="button" data-toggle="collapse" data-parent="#accordion1"
                                                           href="#collapse{{ responses.id }}" aria-expanded="true" aria-controls="collapseOne">
                                                            <em> Vezi raspunsul lui {{ responses.user.username }} </em></a>
                                                    </h4>
                                                </div>
                                                <div id="collapse{{ responses.id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                                    <div class="panel-body">
                                                        <p><span class="glyphicon glyphicon-user"> Raspunsul lui: </span>
                                                            <em> {{ responses.user.username }} </em></p>
                                                        <p><span class="glyphicon glyphicon-time"> din anul domnului: </span>
                                                            <em> {{ responses.commentDate|date('Y d M') }} </em></p>
                                                        <p><span class="glyphicon glyphicon-comment"> care zice ca: </span>
                                                            <em> {{ responses.commentresponse }} </em></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    {% endif %}
                                {% endfor%}
                                {% endif %}
                            {% endfor %}
                            </ul>
                        </div>
                </div>
            </div>
            {% endif %}
        {% endfor %}
    {% endif %}
    </div>
    <div class="col-md-4">
        <div class="row">
            <div class="container-fluid">
                <div class="thumbnail">
                    {% for articleSide in Side %}
                        <h4>Ultimele Articole {{ articleSide.postCategory|capitalize }} </h4>
                        <div class="caption">
                            <p><em>{{ articleSide.postData|truncate(400, true)|raw }}</em></p>
                            <p><em><strong>Scris maiastru in anul domnului: {{ articleSide.ArticleDate|date('Y') }}</strong></em></p>
                            <a href="{{ path('grunt_article', {'page' : articleSide.postCategory, 'id' : articleSide.id }) }}" class="btn btn-info">Citeste mai departe...</a>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="container-fluid">
                <div class="thumbnail">
                    {% for articleAside in Aside %}
                        <h4>Ultimele Articole {{ articleAside.postCategory|capitalize}}</h4>
                        <div class="caption">
                            <p><em>{{ articleAside.postData|truncate(400, true)|raw }}</em></p>
                            <p><em><strong>Scris maiastru in anul domnului: {{ articleAside.ArticleDate|date('Y') }}</strong></em></p>
                            <a href="{{ path('grunt_article', {'page' : articleAside.postCategory, 'id' : articleAside.id }) }}" class="btn btn-info">Citeste mai departe...</a>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Comment Response Modal -->
{% for comment in comments %}

<div class="modal fade" id="commentRespModal{{ comment.id }}" tabindex="-1" role="dialog" aria-labelledby="commentRespModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        {% for articleMain in Main %}
            <div class="modal-header">
                <h3 class="modal-title" id="exampleModalLabel">
                    <em>Zii tu....daca te pricepi mai bine....</em></h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {% for flashMessage in app.session.flashbag.get('succes') %}
                    <div class="panel-heading">
                        <div class="alert alert-success alert-dismissable" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span></button>
                            <h2>{{ flashMessage }}</h2>
                        </div>
                    </div>
                {% endfor %}
                {% for flashMessage in app.session.flashbag.get('comment_exist') %}
                    <div class="panel-body">
                        <div class="panel-heading">
                            <div class="alert alert-warning alert-dismissable" role="alert">
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span></button>
                                <h2>{{ flashMessage }}</h2>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                    <form method="post" id="commentform" name="commentform" enctype="multipart/form-data"
                          action="{{ path ('response_garaj', {'page' : articleMain.postCategory}) }}">
                        <input type="hidden"  name="articleId" value="{{ articleMain.Id }}">
                        <input type="hidden"  name="commentId" value="{{ comment.id }}">
                        <textarea id="comment-response" name="comment-response" class="form-control" rows="4" ></textarea>
                        <div class="row">
                            <div class="col-xs-2 padding-top-10">
                                <button type="submit" class="btn btn-info">Trimite Raspuns</button>
                            </div>
                        </div>
                    </form>

            </div>
        {% endfor %}
        </div>
    </div>
</div>

{% endfor %}
    <div class="row">
        <div class="col-md-12" id="footer">
            Copyright 2017. FildEs Flight Co.
        </div>
    </div>
</div>
{% endblock %}